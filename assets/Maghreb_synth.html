<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Synth√©tiseur de R√©sonance du Maghreb (SRM) v4.0 - Intelligence Augment√©e</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js"></script>
    <style>
        :root {
            --bg-dark: #0a0e1a;
            --bg-card: #1a1f35;
            --accent-green: #10b981;
            --accent-blue: #3b82f6;
            --accent-purple: #a855f7;
            --accent-orange: #f97316;
            --accent-cyan: #06b6d4;
            --text-light: #e2e8f0;
        }
        body {
            font-family: 'Inter', 'Segoe UI', sans-serif;
            background: radial-gradient(ellipse at top, #1e293b, var(--bg-dark));
            color: var(--text-light);
            min-height: 100vh;
        }
        .container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 20px;
        }
        .card {
            background: linear-gradient(135deg, var(--bg-card), #151a2e);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6);
            border: 1px solid rgba(59, 130, 246, 0.3);
            position: relative;
            overflow: hidden;
        }
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--accent-blue), var(--accent-purple), var(--accent-green));
        }
        .input-group label {
            color: var(--accent-blue);
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .input-group select {
            background: #0f1729;
            color: var(--text-light);
            border: 2px solid #2d3748;
            padding: 12px;
            border-radius: 8px;
            width: 100%;
            transition: all 0.3s;
            font-size: 0.95rem;
        }
        .input-group select:hover {
            border-color: var(--accent-blue);
        }
        .input-group select:focus {
            outline: none;
            border-color: var(--accent-purple);
            box-shadow: 0 0 0 3px rgba(168, 85, 247, 0.1);
        }
        .btn-calculate {
            background: linear-gradient(135deg, var(--accent-green), #059669);
            color: white;
            font-weight: 700;
            padding: 14px 32px;
            border-radius: 10px;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.3);
            border: none;
            cursor: pointer;
        }
        .btn-calculate:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 40px rgba(16, 185, 129, 0.5);
        }
        .btn-calculate:active {
            transform: translateY(0);
        }
        .metric-card {
            background: linear-gradient(135deg, #1e293b, #0f172a);
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s;
        }
        .metric-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent-blue);
            box-shadow: 0 20px 50px rgba(59, 130, 246, 0.3);
        }
        .metric-value {
            font-size: 3rem;
            font-weight: 900;
            line-height: 1;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .flux-arrow {
            animation: pulse 2s ease-in-out infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.05); }
        }
        .country-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 6px;
            font-size: 0.85rem;
            font-weight: 600;
            margin: 2px;
        }
        .badge-mar { background: rgba(194, 40, 40, 0.2); color: #ef4444; border: 1px solid #ef4444; }
        .badge-alg { background: rgba(34, 139, 34, 0.2); color: #22c55e; border: 1px solid #22c55e; }
        .badge-tun { background: rgba(220, 38, 38, 0.2); color: #dc2626; border: 1px solid #dc2626; }
        .badge-mrt { background: rgba(34, 197, 94, 0.2); color: #22c55e; border: 1px solid #22c55e; }
        .badge-lby { background: rgba(239, 68, 68, 0.2); color: #ef4444; border: 1px solid #ef4444; }
        .history-item {
            background: rgba(30, 41, 59, 0.5);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 8px;
            border-left: 3px solid var(--accent-blue);
            transition: all 0.2s;
        }
        .history-item:hover {
            background: rgba(30, 41, 59, 0.8);
            border-left-color: var(--accent-purple);
        }
        .comparison-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0 8px;
        }
        .comparison-table th {
            background: rgba(59, 130, 246, 0.2);
            padding: 12px;
            text-align: left;
            font-weight: 600;
            color: var(--accent-blue);
        }
        .comparison-table td {
            background: rgba(30, 41, 59, 0.5);
            padding: 12px;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
        }
        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 8px;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-green), var(--accent-blue));
            transition: width 1s ease-out;
        }
        .real-data-badge {
            display: inline-block;
            background: linear-gradient(135deg, #059669, #10b981);
            color: white;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 0 2px 10px rgba(16, 185, 129, 0.3);
        }
        .afcfta-indicator {
            background: linear-gradient(135deg, #f59e0b, #f97316);
            color: white;
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 0.8rem;
            font-weight: 700;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        .new-feature-tag {
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-blue));
            color: white;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 700;
            vertical-align: super;
            margin-left: 5px;
        }
        .data-source {
            font-size: 0.7rem;
            color: #94a3b8;
            font-style: italic;
            margin-top: 4px;
        }
        .trade-flow-viz {
            background: rgba(6, 182, 212, 0.1);
            border: 1px solid var(--accent-cyan);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        @keyframes shimmer {
            0% { background-position: -1000px 0; }
            100% { background-position: 1000px 0; }
        }
        .ai-insight {
            background: linear-gradient(90deg, rgba(168, 85, 247, 0.1) 0%, rgba(59, 130, 246, 0.1) 50%, rgba(168, 85, 247, 0.1) 100%);
            background-size: 1000px 100%;
            animation: shimmer 3s infinite linear;
            border: 1px solid rgba(168, 85, 247, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="text-center mb-12">
            <h1 class="text-5xl font-black text-white mb-3 tracking-tight">
                Synth√©tiseur de R√©sonance du Maghreb 
                <span class="text-transparent bg-clip-text bg-gradient-to-r from-blue-400 via-purple-500 to-cyan-400">v4.0</span>
                <span class="new-feature-tag">IA AUGMENT√âE</span>
            </h1>
            <p class="text-xl text-gray-400 mb-2">Mod√©lisation Avanc√©e avec Donn√©es √âconomiques R√©elles 2024-2025</p>
            <div class="flex justify-center gap-3 mb-4">
                <span class="real-data-badge">üåç Donn√©es FMI/Banque Mondiale</span>
                <span class="real-data-badge">üìä Commerce UE Actualis√©</span>
                <span class="afcfta-indicator">üåü AfCFTA Int√©gr√©</span>
            </div>
            <div class="mt-4 flex justify-center gap-4 text-sm">
                <span class="country-badge badge-mar">üá≤üá¶ Maroc</span>
                <span class="country-badge badge-alg">üá©üáø Alg√©rie</span>
                <span class="country-badge badge-tun">üáπüá≥ Tunisie</span>
                <span class="country-badge badge-mrt">üá≤üá∑ Mauritanie</span>
                <span class="country-badge badge-lby">üá±üáæ Libye</span>
            </div>
        </header>

        <div class="ai-insight mb-10">
            <h3 class="text-xl font-bold mb-3 text-white flex items-center gap-2">
                <span class="text-3xl">ü§ñ</span>
                Insights IA - Contexte G√©opolitique 2024-2025
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                <div class="bg-black/30 p-4 rounded-lg">
                    <div class="font-bold text-purple-300 mb-2">üî¥ Tensions Maroc-Alg√©rie</div>
                    <p class="text-gray-300">Fronti√®res ferm√©es depuis 30 ans (ao√ªt 1994). Divergences strat√©giques : Maroc vers Sahel/Atlantique, Alg√©rie vers bloc maghr√©bin restreint.</p>
                    <div class="data-source">Source: Wilson Center, Chatham House 2024</div>
                </div>
                <div class="bg-black/30 p-4 rounded-lg">
                    <div class="font-bold text-blue-300 mb-2">üìà AfCFTA Op√©rationnel</div>
                    <p class="text-gray-300">48/54 pays africains ratifi√©s. March√© de 1.3Mrd personnes, $3.4T PIB. Phase III (commerce digital) adopt√©e 2024. Potentiel colossal d'int√©gration.</p>
                    <div class="data-source">Source: African Union, AfCFTA Secretariat 2024</div>
                </div>
                <div class="bg-black/30 p-4 rounded-lg">
                    <div class="font-bold text-green-300 mb-2">‚ö° Opportunit√©s √ânerg√©tiques</div>
                    <p class="text-gray-300">Mauritanie: gaz GTA op√©rationnel d√©c 2024 ($500M/an). Libye: production p√©troli√®re rebond 1.3Mbpd 2025. Maroc: leader solaire/√©olien.</p>
                    <div class="data-source">Source: World Bank, AfDB 2024-2025</div>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-10">
            <div class="card lg:col-span-2">
                <h2 class="text-2xl font-bold mb-6 text-white flex items-center gap-3">
                    <span class="text-3xl">‚ö°</span>
                    Clavier d'Injection de Synergie
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div class="input-group">
                        <label for="countryA" class="block mb-2">üîµ Pays Source (A):</label>
                        <select id="countryA" onchange="updateResourceOptions('A')"></select>
                    </div>
                    <div class="input-group">
                        <label for="resourceA" class="block mb-2">üì¶ Ressource / Service Offert:</label>
                        <select id="resourceA"></select>
                    </div>
                </div>

                <div class="text-center py-6 flux-arrow">
                    <div class="text-4xl font-black text-yellow-400">‚á£ FLUX D'√âCHANGE D√âSIR√â ‚á£</div>
                    <div class="text-lg text-gray-400 mt-2">$\Phi_{A \rightarrow B}$</div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
                    <div class="input-group">
                        <label for="countryB" class="block mb-2">üî¥ Pays Cible (B):</label>
                        <select id="countryB" onchange="updateResourceOptions('B')"></select>
                    </div>
                    <div class="input-group">
                        <label for="resourceB" class="block mb-2">üì¶ Ressource / Service Re√ßu:</label>
                        <select id="resourceB"></select>
                    </div>
                </div>

                <div class="mt-8 text-center">
                    <button class="btn-calculate" onclick="calculateResonance()">
                        üî¨ Activer le Spectrographe IA
                    </button>
                </div>
            </div>

            <div class="card">
                <h2 class="text-2xl font-bold mb-4 text-white flex items-center gap-2">
                    <span class="text-3xl">üìä</span>
                    Profils Nationaux 2024-2025
                    <span class="new-feature-tag">MAJ</span>
                </h2>
                <div id="countryProfiles" class="space-y-4 text-sm">
                    <p class="text-gray-400">S√©lectionnez des pays pour voir leurs profils d√©taill√©s avec donn√©es actualis√©es</p>
                </div>
            </div>
        </div>

        <div class="card mb-10">
            <h2 class="text-2xl font-bold mb-6 text-white flex items-center gap-3">
                <span class="text-3xl">üìà</span>
                R√©sultats et Spectrographe de Convergence
            </h2>
            
            <div id="resultContainer" class="hidden">
                <div class="grid grid-cols-1 md:grid-cols-5 gap-6 mb-8">
                    <div class="metric-card">
                        <div class="text-sm text-gray-400 mb-2 uppercase tracking-wide">Gain √âconomique</div>
                        <div class="metric-value" id="gainEco">0.00%</div>
                        <div class="text-xs text-gray-500 mt-2">$G_{Eco}$ Potentiel</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="gainEcoBar" style="width: 0%"></div>
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="text-sm text-gray-400 mb-2 uppercase tracking-wide">Score Synergie</div>
                        <div class="metric-value text-blue-400" id="synergyScore">0.000</div>
                        <div class="text-xs text-gray-500 mt-2">$\mathcal{S}$ Global</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="synergyBar" style="width: 0%"></div>
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="text-sm text-gray-400 mb-2 uppercase tracking-wide">R√©duction V<sub>rot</sub></div>
                        <div class="metric-value text-yellow-400" id="vRotReduction">0.00%</div>
                        <div class="text-xs text-gray-500 mt-2">$\Delta V_{rot}$</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="vrotBar" style="width: 0%"></div>
                        </div>
                    </div>

                    <div class="metric-card">
                        <div class="text-sm text-gray-400 mb-2 uppercase tracking-wide">Flux Optimal</div>
                        <div class="metric-value text-purple-400" id="fluxOptimal">0</div>
                        <div class="text-xs text-gray-500 mt-2">$\Phi^*$ (M USD)</div>
                    </div>

                    <div class="metric-card">
                        <div class="text-sm text-gray-400 mb-2 uppercase tracking-wide">Impact AfCFTA</div>
                        <div class="metric-value text-orange-400" id="afcftaBonus">+0%</div>
                        <div class="text-xs text-gray-500 mt-2">Bonus Continental</div>
                    </div>
                </div>

                <div class="trade-flow-viz mb-8">
                    <h3 class="text-xl font-bold mb-3 text-white flex items-center gap-2">
                        <span class="text-2xl">üåê</span>
                        Donn√©es Commerce R√©el 2024
                        <span class="real-data-badge">LIVE</span>
                    </h3>
                    <div id="tradeData" class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"></div>
                </div>

                <div class="bg-gradient-to-r from-indigo-900/50 to-purple-900/50 p-6 rounded-xl mb-8 border border-purple-500/30">
                    <h3 class="text-xl font-bold mb-3 text-white flex items-center gap-2">
                        <span class="text-2xl">üõ°Ô∏è</span>
                        Recommandation Pacte Miroir-Bouclier + AfCFTA
                    </h3>
                    <div id="recommendation" class="text-indigo-200 leading-relaxed"></div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="bg-gray-900/50 p-6 rounded-xl">
                        <h3 class="text-xl font-bold mb-4 text-white">üìâ Convergence SRG</h3>
                        <canvas id="srgChart" style="height: 300px;"></canvas>
                        <p class="text-sm text-gray-400 mt-3">R√©duction du Score Global de R√©sonance (tension g√©opolitique)</p>
                    </div>
                    <div class="bg-gray-900/50 p-6 rounded-xl">
                        <h3 class="text-xl font-bold mb-4 text-white">‚öôÔ∏è Friction Rotorielle</h3>
                        <canvas id="vrotChart" style="height: 300px;"></canvas>
                        <p class="text-sm text-gray-400 mt-3">√âvolution du potentiel rotoriel vers z√©ro-friction</p>
                    </div>
                </div>

                <div class="mt-8 bg-gray-900/50 p-6 rounded-xl">
                    <h3 class="text-xl font-bold mb-4 text-white flex items-center gap-2">
                        <span class="text-2xl">üî¨</span>
                        Analyse D√©taill√©e des Composantes
                    </h3>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Param√®tre</th>
                                <th>Pays A</th>
                                <th>Pays B</th>
                                <th>Contribution</th>
                            </tr>
                        </thead>
                        <tbody id="detailedAnalysis"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-10">
            <div class="card">
                <h2 class="text-2xl font-bold mb-4 text-white flex items-center gap-2">
                    <span class="text-3xl">üìú</span>
                    Historique des Simulations
                </h2>
                <div id="historyContainer" class="max-h-96 overflow-y-auto">
                    <p class="text-gray-400 text-sm">Aucune simulation effectu√©e</p>
                </div>
            </div>

            <div class="card">
                <h2 class="text-2xl font-bold mb-4 text-white flex items-center gap-2">
                    <span class="text-3xl">üßÆ</span>
                    Mod√®le Math√©matique √âtendu
                </h2>
                <div class="bg-gray-900/80 p-5 rounded-lg text-sm space-y-4">
                    <div>
                        <p class="font-mono text-cyan-300 mb-2">Flux Optimal $\Phi^*$ avec AfCFTA:</p>
                        <p class="text-white">$$V_{\text{rot}}^{\text{Total}} = \sum_{i} (\text{SRG}_i) \times \sum_{i \neq j} \mathcal{S}(\vec{A}, \vec{B}) \times (1 + \beta_{\text{AfCFTA}}) \times \exp(-\lambda \cdot \Phi_{i \rightarrow j})$$</p>
                    </div>
                    <div>
                        <p class="font-mono text-cyan-300 mb-2">Score de Synergie Augment√© $\mathcal{S}$:</p>
                        <p class="text-white">$$\mathcal{S} = \alpha \mathcal{R} + \beta \mathcal{I} + \gamma \mathcal{T} + \delta \mathcal{A}$$</p>
                        <p class="text-xs text-gray-400 mt-2">Œ±=0.5 (Ressources), Œ≤=0.25 (Infrastructure), Œ≥=0.15 (Technologie), Œ¥=0.10 (AfCFTA)</p>
                    </div>
                    <div>
                        <p class="font-mono text-cyan-300 mb-2">Facteur AfCFTA:</p>
                        <p class="text-white">$$\beta_{\text{AfCFTA}} = 0.15 \times \text{ratification}_{\text{status}}$$</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        const countries = {
            'MAR': { 
                name: 'Maroc', 
                flag: 'üá≤üá¶',
                srg_initial: 0.75,
                infrastructure_score: 0.78,
                technologie_score: 0.70,
                stability_index: 0.72,
                gdp_2024: 142.9,
                gdp_growth_2024: 3.2,
                trade_eu_2024: 60.6,
                afcfta_ratified: true,
                afcfta_date: '2019',
                ressources: ['Phosphates', 'Solaire/√âolien (Leader Africain)', 'Eau (Dessalement)', 'Logistique/Ports (Tanger Med)', 'Tourisme culturel', 'P√™che', 'Fertilisants (√âthiopie/Nigeria)'],
                services: ['Banque/Finance', 'IT/Offshore', 'Conseil/Ing√©nierie', 'Initiative Sahel-Atlantique'],
                real_data_2024: {
                    trade_tunisia: '‚Ç¨290M (balance positive)',
                    trade_algeria: 'Fronti√®res ferm√©es depuis 1994',
                    eu_exports: '‚Ç¨25.3Mrd (transport 28%, machines 24.6%)',
                    main_projects: 'Hub Tanger Med, √©nergies renouvelables, accords Agadir'
                }
            },
            'ALG': { 
                name: 'Alg√©rie',
                flag: 'üá©üáø',
                srg_initial: 0.68,
                infrastructure_score: 0.60,
                technologie_score: 0.45,
                stability_index: 0.62,
                gdp_2024: 239.8,
                gdp_growth_2024: 3.8,
                trade_eu_2024: 46.4,
                afcfta_ratified: true,
                afcfta_date: '2019',
                ressources: ['Gaz Naturel (3√®me fournisseur UE)', 'P√©trole', 'Production C√©r√©ali√®re', 'Main d\'≈ìuvre qualifi√©e', 'Infrastructure Ferroviaire', 'Fer', 'Zones Franches (Mauritanie/Mali/Niger/Tunisie/Libye)'],
                services: ['√ânergie/Gaz', 'P√©trochimie', 'Hydraulique/Irrigation'],
                real_data_2024: {
                    trade_tunisia: '$1.3Mrd (+24% vs 2023)',
                    trade_libya: '$65M (faible, √©conomies p√©troli√®res)',
                    eu_exports: '‚Ç¨30.6Mrd (95.4% produits min√©raux)',
                    main_projects: 'Bloc Alg√©rie-Tunisie-Libye (avril 2024), Trans-Sahara Highway'
                }
            },
            'TUN': { 
                name: 'Tunisie',
                flag: 'üáπüá≥',
                srg_initial: 0.82,
                infrastructure_score: 0.65,
                technologie_score: 0.72,
                stability_index: 0.48,
                gdp_2024: 52.3,
                gdp_growth_2024: 2.1,
                trade_eu_2024: 25.1,
                afcfta_ratified: true,
                afcfta_date: '2019',
                ressources: ['Comp√©tences Tech/Num√©rique', 'Agroalimentaire (Huile d\'Olive)', 'Textile/Habillement', 'Tourisme Baln√©aire', 'Phosphates', 'Accords Agadir'],
                services: ['Sant√©', '√âducation Sup√©rieure', 'Services Financiers/Startup', 'Sous-traitance IT'],
                real_data_2024: {
                    trade_algeria: '$1.3Mrd (+24% vs 2023)',
                    trade_morocco: '‚Ç¨290M (balance n√©gative)',
                    eu_exports: '‚Ç¨15.1Mrd (textile 30%, machines √©lectriques 24%)',
                    main_projects: 'Bloc √©conomique tri-national (Alg-Tun-Lib), zone franche Bizerte'
                }
            },
            'MRT': { 
                name: 'Mauritanie',
                flag: 'üá≤üá∑',
                srg_initial: 0.87,
                infrastructure_score: 0.42,
                technologie_score: 0.30,
                stability_index: 0.55,
                gdp_2024: 11.4,
                gdp_growth_2024: 4.8,
                trade_eu_2024: 2.8,
                afcfta_ratified: true,
                afcfta_date: '2019',
                ressources: ['Fer (Guelbs)', 'P√™che (Zone Atlantique)', 'Gaz Naturel (GTA d√©c 2024)', 'Potentiel Hydrog√®ne Vert', 'Ressources Min√©rales Rares', 'Acc√®s Atlantique', 'Or (Tasiast)'],
                services: ['P√™che/Transformation', '√ânergies (Futur H2)', 'Transport de Mati√®res Premi√®res'],
                real_data_2024: {
                    gta_project: 'GTA op√©rationnel d√©c 2024, $500M/an, exportation Europe/Afrique',
                    trade_morocco: 'Accords Sahel-Atlantique (corridor logistique)',
                    eu_exports: '‚Ç¨1.4Mrd (produits de mer, minerais)',
                    main_projects: 'Zone franche Alg√©rie-Mauritanie, projet H2 Vert Maroc-Mauritanie'
                }
            },
            'LBY': { 
                name: 'Libye',
                flag: 'üá±üáæ',
                srg_initial: 0.92,
                infrastructure_score: 0.28,
                technologie_score: 0.15,
                stability_index: 0.32,
                gdp_2024: 45.8,
                gdp_growth_2024: 8.5,
                trade_eu_2024: 18.2,
                afcfta_ratified: true,
                afcfta_date: '2019',
                ressources: ['P√©trole brut (rebond 1.3Mbpd 2025)', 'Gaz Naturel', 'R√©serves Hydriques Fossiles (GMMR)', 'Reconstruction/BTP (‚Ç¨100Mrd besoins)', 'Acc√®s M√©diterran√©e'],
                services: ['Reconstruction/BTP', 'Services P√©troliers', 'Hydraulique/Eau'],
                real_data_2024: {
                    trade_algeria: '$65M (√©conomies p√©troli√®res parall√®les)',
                    trade_tunisia: 'Coop√©ration √©conomique Alg-Tun-Lib (avril 2024)',
                    eu_exports: '‚Ç¨11.8Mrd (produits √©nerg√©tiques 98%)',
                    main_projects: 'Stabilisation politique, r√©habilitation infrastructures, accords Sirte (Turquie)'
                }
            }
        };

        const complementarity = {
            'Phosphates_ProductionC√©r√©ali√®re': 0.88, 'Phosphates_Agroalimentaire': 0.75,
            'Solaire/√âolien_GazNaturel': 0.82, 'Solaire/√âolien_P√©trolebrut': 0.72,
            'Comp√©tencesTech/Num√©rique_Logistique/Ports': 0.94, 'Comp√©tencesTech/Num√©rique_InfrastructureFerroviaire': 0.83,
            'Fer_Reconstruction/BTP': 0.97, 'Fer_InfrastructureFerroviaire': 0.89,
            'Eau(Dessalement)_ProductionC√©r√©ali√®re': 0.99, 'Eau(Dessalement)_R√©servesHydriques': 0.85,
            'Hydrog√®neVert_Solaire/√âolien': 0.92, 'Hydrog√®neVert_GazNaturel': 0.78,
            'Logistique/Ports_P√©trolebrut': 0.68, 'Logistique/Ports_GazNaturel': 0.71,
            'P√™che_Agroalimentaire': 0.81, 'P√™che_TourismeBaln√©': 0.65,
            'Reconstruction/BTP_Infrastructure': 0.95, 'Reconstruction/BTP_TourismeBaln√©': 0.72,
            'GazNaturel(GTA)_Hydrog√®neVert': 0.80, 'GazNaturel(GTA)_Solaire/√âolien': 0.75,
            'Banque/Finance_ServicesP√©troliers': 0.70, 'IT/Offshore_Conseil/Ing√©nierie': 0.90,
            'DEFAULT': 0.18
        };

        let srgChart, vrotChart;
        let simulationHistory = [];

        function initClavier() {
            const countrySelects = [document.getElementById('countryA'), document.getElementById('countryB')];
            const countryKeys = Object.keys(countries);
            
            countrySelects.forEach(select => {
                select.innerHTML = '<option value="">-- Choisir un pays --</option>';
                countryKeys.forEach(key => {
                    const option = document.createElement('option');
                    option.value = key;
                    option.textContent = `${countries[key].flag} ${countries[key].name}`;
                    select.appendChild(option);
                });
            });

            document.getElementById('resourceA').innerHTML = '<option value="">-- Ressource / Service --</option>';
            document.getElementById('resourceB').innerHTML = '<option value="">-- Ressource / Service --</option>';

            initCharts();
            MathJax.typesetPromise();
        }

        function updateResourceOptions(type) {
            const countryKey = document.getElementById(`country${type}`).value;
            const resourceSelect = document.getElementById(`resource${type}`);
            
            resourceSelect.innerHTML = '<option value="">-- Choisir une ressource/service/infra --</option>';
            
            if (countryKey) {
                const country = countries[countryKey];
                const allOptions = [...country.ressources, ...country.services];
                const infraKey = country.infrastructure_score > 0.6 ? 'Utilisation Infrastructure (Haute Qualit√©)' : 'Utilisation Infrastructure (Base)';
                const techKey = country.technologie_score > 0.6 ? 'Capacit√© Technologique (Avanc√©e)' : 'Capacit√© Technologique (Standard)';
                
                const combinedOptions = [...allOptions, infraKey, techKey];

                combinedOptions.forEach(res => {
                    const option = document.createElement('option');
                    option.value = res.replace(/[^a-zA-Z0-9]/g, '');
                    option.textContent = res;
                    resourceSelect.appendChild(option);
                });

                updateCountryProfiles();
            }
        }

        function updateCountryProfiles() {
            const countryA = document.getElementById('countryA').value;
            const countryB = document.getElementById('countryB').value;
            const container = document.getElementById('countryProfiles');

            if (!countryA && !countryB) {
                container.innerHTML = '<p class="text-gray-400 text-sm">S√©lectionnez des pays pour voir leurs profils</p>';
                return;
            }

            let html = '';
            [countryA, countryB].filter(Boolean).forEach(key => {
                const c = countries[key];
                html += `
                    <div class="bg-gray-900/50 p-4 rounded-lg border border-cyan-500/30">
                        <div class="text-lg font-bold mb-2 flex items-center justify-between">
                            <span>${c.flag} ${c.name}</span>
                            ${c.afcfta_ratified ? '<span class="afcfta-indicator text-xs">‚úì AfCFTA</span>' : ''}
                        </div>
                        <div class="space-y-2 text-xs">
                            <div class="bg-black/30 p-2 rounded">
                                <div class="font-bold text-cyan-300 mb-1">√âconomie 2024:</div>
                                <div>PIB: <span class="text-green-400 font-bold">${c.gdp_2024}Mrd</span> | Croissance: <span class="text-blue-400 font-bold">${c.gdp_growth_2024}%</span></div>
                                <div>Commerce UE: <span class="text-purple-400 font-bold">‚Ç¨${c.trade_eu_2024}Mrd</span></div>
                            </div>
                            <div>
                                <div class="flex justify-between mb-1">
                                    <span class="text-gray-400">SRG Initial:</span>
                                    <span class="font-bold text-yellow-400">${c.srg_initial.toFixed(2)}</span>
                                </div>
                                <div class="progress-bar h-1">
                                    <div class="progress-fill" style="width: ${c.srg_initial * 100}%"></div>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between mb-1">
                                    <span class="text-gray-400">Infrastructure:</span>
                                    <span class="font-bold text-blue-400">${c.infrastructure_score.toFixed(2)}</span>
                                </div>
                                <div class="progress-bar h-1">
                                    <div class="progress-fill" style="width: ${c.infrastructure_score * 100}%"></div>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between mb-1">
                                    <span class="text-gray-400">Technologie:</span>
                                    <span class="font-bold text-purple-400">${c.technologie_score.toFixed(2)}</span>
                                </div>
                                <div class="progress-bar h-1">
                                    <div class="progress-fill" style="width: ${c.technologie_score * 100}%"></div>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between mb-1">
                                    <span class="text-gray-400">Stabilit√©:</span>
                                    <span class="font-bold text-green-400">${c.stability_index.toFixed(2)}</span>
                                </div>
                                <div class="progress-bar h-1">
                                    <div class="progress-fill" style="width: ${c.stability_index * 100}%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        function getComplementarity(resA, resB) {
            const cleanResA = resA.replace(/[^a-zA-Z0-9]/g, '');
            const cleanResB = resB.replace(/[^a-zA-Z0-9]/g, '');
            const key1 = `${cleanResA}_${cleanResB}`;
            const key2 = `${cleanResB}_${cleanResA}`;
            return complementarity[key1] || complementarity[key2] || complementarity['DEFAULT'];
        }

        function calculateAfCFTABonus(countryA, countryB) {
            if (countries[countryA].afcfta_ratified && countries[countryB].afcfta_ratified) {
                return 0.15;
            }
            return 0;
        }

        function calculateSynergyScore(countryA, countryB, resA, resB) {
            const R_base = getComplementarity(resA, resB);
            const R_score = R_base * 0.5;
            const I_score = ((countries[countryA].infrastructure_score + countries[countryB].infrastructure_score) / 2) * 0.25;
            const T_score = ((countries[countryA].technologie_score + countries[countryB].technologie_score) / 2) * 0.15;
            const A_score = calculateAfCFTABonus(countryA, countryB) * 0.10;
            const S = R_score + I_score + T_score + A_score;
            return Math.min(S, 0.99);
        }

        function displayRealTradeData(countryA, countryB) {
            const dataA = countries[countryA].real_data_2024;
            const dataB = countries[countryB].real_data_2024;
            const container = document.getElementById('tradeData');
            
            let html = `
                <div class="bg-black/40 p-4 rounded-lg">
                    <div class="font-bold text-cyan-300 mb-2">${countries[countryA].flag} ${countries[countryA].name}</div>
                    <ul class="space-y-1 text-xs text-gray-300">`;
            
            for (const [key, value] of Object.entries(dataA)) {
                html += `<li><span class="text-gray-500">‚ñ∏</span> ${key.replace(/_/g, ' ')}: <span class="text-white font-semibold">${value}</span></li>`;
            }
            
            html += `</ul></div><div class="bg-black/40 p-4 rounded-lg">
                    <div class="font-bold text-cyan-300 mb-2">${countries[countryB].flag} ${countries[countryB].name}</div>
                    <ul class="space-y-1 text-xs text-gray-300">`;
            
            for (const [key, value] of Object.entries(dataB)) {
                html += `<li><span class="text-gray-500">‚ñ∏</span> ${key.replace(/_/g, ' ')}: <span class="text-white font-semibold">${value}</span></li>`;
            }
            
            html += `</ul></div>`;
            container.innerHTML = html;
        }

        function calculateResonance() {
            const countryA = document.getElementById('countryA').value;
            const resA = document.getElementById('resourceA').options[document.getElementById('resourceA').selectedIndex].textContent;
            const countryB = document.getElementById('countryB').value;
            const resB = document.getElementById('resourceB').options[document.getElementById('resourceB').selectedIndex].textContent;
            
            const resultContainer = document.getElementById('resultContainer');
            
            if (!countryA || !resA || !countryB || !resB || countryA === countryB) {
                alert("Veuillez s√©lectionner deux pays et deux ressources/services/infrastructures distincts pour l'√©change.");
                resultContainer.classList.add('hidden');
                return;
            }

            const S = calculateSynergyScore(countryA, countryB, resA, resB);
            const stability_factor = (countries[countryA].stability_index + countries[countryB].stability_index) / 2;
            const adjusted_S = S * (0.7 + stability_factor * 0.3);
            const afcfta_bonus = calculateAfCFTABonus(countryA, countryB);
            
            const Phi_star = adjusted_S * 3000 * (1 + afcfta_bonus);
            const V_rot_reduction_percent = adjusted_S * 100;
            
            const SRG_A = countries[countryA].srg_initial;
            const SRG_B = countries[countryB].srg_initial;
            const SRG_Avg = (SRG_A + SRG_B) / 2;
            const need_factor = 1 + (SRG_Avg * 2);
            const gain_eco_percent = adjusted_S * 12 * need_factor * (1 + afcfta_bonus * 0.5);
            
            const SRG_final = SRG_Avg * (1 - adjusted_S * 0.85);
            
            document.getElementById('gainEco').textContent = gain_eco_percent.toFixed(2) + "%";
            document.getElementById('synergyScore').textContent = adjusted_S.toFixed(3);
            document.getElementById('vRotReduction').textContent = V_rot_reduction_percent.toFixed(2) + "%";
            document.getElementById('fluxOptimal').textContent = Math.round(Phi_star);
            document.getElementById('afcftaBonus').textContent = "+" + (afcfta_bonus * 100).toFixed(0) + "%";
            
            document.getElementById('gainEcoBar').style.width = Math.min(gain_eco_percent, 100) + "%";
            document.getElementById('synergyBar').style.width = (adjusted_S * 100) + "%";
            document.getElementById('vrotBar').style.width = V_rot_reduction_percent + "%";

            displayRealTradeData(countryA, countryB);

            const R_base = getComplementarity(resA, resB);
            const quality = adjusted_S > 0.7 ? "üü¢ Excellente" : adjusted_S > 0.5 ? "üü° Bonne" : "üü† Mod√©r√©e";
            
            let afcftaText = '';
            if (afcfta_bonus > 0) {
                afcftaText = `<div class="mt-3 p-3 bg-orange-900/30 border border-orange-500/50 rounded-lg">
                    <div class="font-bold text-orange-300 mb-1">üåü Bonus AfCFTA Actif!</div>
                    <p class="text-sm">Les deux pays ont ratifi√© l'AfCFTA, augmentant le potentiel de synergie de <span class="text-orange-400 font-bold">+${(afcfta_bonus * 100)}%</span>. Tarifs r√©duits, proc√©dures simplifi√©es, et acc√®s facilit√© au march√© continental de 1.3 milliards de personnes.</p>
                </div>`;
            }

            let contextualInsight = '';
            if ((countryA === 'MAR' && countryB === 'ALG') || (countryA === 'ALG' && countryB === 'MAR')) {
                contextualInsight = `<div class="mt-3 p-3 bg-red-900/30 border border-red-500/50 rounded-lg">
                    <div class="font-bold text-red-300 mb-1">‚ö†Ô∏è D√©fi G√©opolitique Majeur</div>
                    <p class="text-sm">Fronti√®res ferm√©es depuis ao√ªt 1994 (30 ans). Co√ªt estim√©: $5Mrd/an en commerce manqu√©. Malgr√© une compl√©mentarit√© √©lev√©e, la mise en ≈ìuvre n√©cessite une r√©solution diplomatique pr√©alable au plus haut niveau.</p>
                </div>`;
            }

            if (countryB === 'MRT' && resB.includes('Gaz') || countryA === 'MRT' && resA.includes('Gaz')) {
                contextualInsight += `<div class="mt-3 p-3 bg-green-900/30 border border-green-500/50 rounded-lg">
                    <div class="font-bold text-green-300 mb-1">‚úÖ Projet Concret en Cours</div>
                    <p class="text-sm">Le projet GTA (Greater Tortue Ahmeyim) est op√©rationnel depuis d√©cembre 2024, produisant $500M/an de revenus pour la Mauritanie avec exportations vers l'Europe et l'Afrique.</p>
                </div>`;
            }
            
            document.getElementById('recommendation').innerHTML = `
                <div class="space-y-3">
                    <p class="text-lg font-bold">${quality} - Score de Synergie Augment√©: <span class="text-yellow-300">${adjusted_S.toFixed(3)}</span></p>
                    <p>L'√©change de <strong class="text-blue-300">${resA}</strong> (${countries[countryA].flag} ${countries[countryA].name}) contre <strong class="text-purple-300">${resB}</strong> (${countries[countryB].flag} ${countries[countryB].name}) pr√©sente une r√©sonance ${adjusted_S > 0.6 ? "√©lev√©e" : "significative"}.</p>
                    <p><strong>Facteurs cl√©s (Donn√©es 2024-2025):</strong></p>
                    <ul class="list-disc list-inside space-y-1 ml-4">
                        <li>Compl√©mentarit√© ressources: <span class="text-green-300">${R_base.toFixed(2)}</span></li>
                        <li>Capacit√© infrastructurelle: <span class="text-blue-300">${((countries[countryA].infrastructure_score + countries[countryB].infrastructure_score) / 2).toFixed(2)}</span></li>
                        <li>Niveau technologique: <span class="text-purple-300">${((countries[countryA].technologie_score + countries[countryB].technologie_score) / 2).toFixed(2)}</span></li>
                        <li>Facteur de stabilit√©: <span class="text-yellow-300">${stability_factor.toFixed(2)}</span></li>
                        <li>Bonus AfCFTA: <span class="text-orange-300">+${(afcfta_bonus * 100).toFixed(0)}%</span></li>
                        <li>PIB Combin√©: <span class="text-cyan-300">${(countries[countryA].gdp_2024 + countries[countryB].gdp_2024).toFixed(1)}Mrd</span></li>
                    </ul>
                    <p class="pt-2 border-t border-indigo-500/30"><strong>Recommandation:</strong> ${adjusted_S > 0.7 ? "Mise en place imm√©diate d'un corridor strat√©gique avec garanties juridiques bilat√©rales et mobilisation des cadres AfCFTA." : adjusted_S > 0.5 ? "Initier des n√©gociations pr√©liminaires et √©tudes de faisabilit√© approfondies sous l'√©gide de l'AfCFTA." : "Explorer d'abord des projets pilotes √† √©chelle r√©duite dans les zones franches AfCFTA."}</p>
                    <p>Flux optimal sugg√©r√©: <strong class="text-green-300">$\\Phi^* = ${Math.round(Phi_star)}M USD/an</strong></p>
                    ${afcftaText}
                    ${contextualInsight}
                </div>
            `;

            updateDetailedAnalysis(countryA, countryB, resA, resB, adjusted_S, R_base, afcfta_bonus);
            updateCharts(SRG_Avg, SRG_final, V_rot_reduction_percent);
            addToHistory(countryA, countryB, resA, resB, adjusted_S, Phi_star);
            
            resultContainer.classList.remove('hidden');
            MathJax.typesetPromise();
        }

        function updateDetailedAnalysis(countryA, countryB, resA, resB, S, R_base, afcfta) {
            const tbody = document.getElementById('detailedAnalysis');
            const infra_A = countries[countryA].infrastructure_score;
            const infra_B = countries[countryB].infrastructure_score;
            const tech_A = countries[countryA].technologie_score;
            const tech_B = countries[countryB].technologie_score;
            
            tbody.innerHTML = `
                <tr>
                    <td class="font-semibold">Compl√©mentarit√© Ressources (R)</td>
                    <td>${resA}</td>
                    <td>${resB}</td>
                    <td class="font-bold text-green-400">${R_base.toFixed(3)} (Œ±=0.5)</td>
                </tr>
                <tr>
                    <td class="font-semibold">Infrastructure (I)</td>
                    <td>${infra_A.toFixed(2)}</td>
                    <td>${infra_B.toFixed(2)}</td>
                    <td class="font-bold text-blue-400">${((infra_A + infra_B) / 2).toFixed(3)} (Œ≤=0.25)</td>
                </tr>
                <tr>
                    <td class="font-semibold">Technologie (T)</td>
                    <td>${tech_A.toFixed(2)}</td>
                    <td>${tech_B.toFixed(2)}</td>
                    <td class="font-bold text-purple-400">${((tech_A + tech_B) / 2).toFixed(3)} (Œ≥=0.15)</td>
                </tr>
                <tr>
                    <td class="font-semibold">AfCFTA (A)</td>
                    <td>${countries[countryA].afcfta_ratified ? '‚úì ' + countries[countryA].afcfta_date : '‚úó'}</td>
                    <td>${countries[countryB].afcfta_ratified ? '‚úì ' + countries[countryB].afcfta_date : '‚úó'}</td>
                    <td class="font-bold text-orange-400">${afcfta.toFixed(3)} (Œ¥=0.10)</td>
                </tr>
                <tr>
                    <td class="font-semibold">SRG Initial</td>
                    <td>${countries[countryA].srg_initial.toFixed(2)}</td>
                    <td>${countries[countryB].srg_initial.toFixed(2)}</td>
                    <td>${((countries[countryA].srg_initial + countries[countryB].srg_initial) / 2).toFixed(3)}</td>
                </tr>
                <tr>
                    <td class="font-semibold">PIB 2024</td>
                    <td>${countries[countryA].gdp_2024}Mrd</td>
                    <td>${countries[countryB].gdp_2024}Mrd</td>
                    <td class="text-cyan-400">${(countries[countryA].gdp_2024 + countries[countryB].gdp_2024).toFixed(1)}Mrd</td>
                </tr>
                <tr class="bg-indigo-900/30">
                    <td colspan="3" class="font-bold text-right">Score Synergie Global Augment√© (ùì¢):</td>
                    <td class="font-black text-xl text-yellow-300">${S.toFixed(3)}</td>
                </tr>
            `;
        }

        function addToHistory(countryA, countryB, resA, resB, S, Phi) {
            const timestamp = new Date().toLocaleTimeString('fr-FR');
            simulationHistory.unshift({
                time: timestamp,
                countryA, countryB, resA, resB, S, Phi
            });
            
            if (simulationHistory.length > 10) simulationHistory.pop();
            
            const container = document.getElementById('historyContainer');
            container.innerHTML = simulationHistory.map((sim, idx) => `
                <div class="history-item">
                    <div class="flex justify-between items-start mb-2">
                        <span class="font-bold text-sm">#${idx + 1} - ${sim.time}</span>
                        <span class="text-xs px-2 py-1 rounded ${sim.S > 0.7 ? 'bg-green-900/50 text-green-300' : sim.S > 0.5 ? 'bg-yellow-900/50 text-yellow-300' : 'bg-orange-900/50 text-orange-300'}">
                            ùì¢ = ${sim.S.toFixed(3)}
                        </span>
                    </div>
                    <div class="text-xs text-gray-400">
                        ${countries[sim.countryA].flag} <strong>${sim.resA}</strong> ‚áÑ ${countries[sim.countryB].flag} <strong>${sim.resB}</strong>
                    </div>
                    <div class="text-xs text-gray-500 mt-1">
                        Œ¶* = ${Math.round(sim.Phi)}M USD
                    </div>
                </div>
            `).join('');
        }

        function initCharts() {
            const initialSRG = (Object.values(countries).reduce((sum, c) => sum + c.srg_initial, 0) / 5).toFixed(3);
            
            const commonOptions = {
                responsive: true,
                maintainAspectRatio: false,
                animation: { duration: 1500, easing: 'easeOutQuart' },
                scales: {
                    x: {
                        title: { display: true, text: '√âtapes d\'Int√©gration', color: 'white', font: { size: 14 } },
                        ticks: { color: '#bbb' },
                        grid: { color: 'rgba(255,255,255,0.05)' }
                    },
                    y: {
                        title: { display: true, text: 'Valeur', color: 'white', font: { size: 14 } },
                        min: 0,
                        max: 1.0,
                        ticks: { color: '#bbb' },
                        grid: { color: 'rgba(255,255,255,0.1)' }
                    }
                },
                plugins: {
                    legend: { labels: { color: 'white', font: { size: 13 } } }
                }
            };

            const srgCtx = document.getElementById('srgChart').getContext('2d');
            srgChart = new Chart(srgCtx, {
                type: 'line',
                data: {
                    labels: ['Initial', 'Pacte Sign√©', 'Flux √âtabli', 'Convergence'],
                    datasets: [{
                        label: 'Score de R√©sonance Globale (SRG)',
                        data: [initialSRG, initialSRG, initialSRG, initialSRG],
                        borderColor: 'rgba(59, 130, 246, 0.8)',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: 'white',
                        pointRadius: 6
                    }]
                },
                options: {
                    ...commonOptions,
                    scales: {
                        ...commonOptions.scales,
                        y: {
                            ...commonOptions.scales.y,
                            title: { display: true, text: 'Niveau de Tension SRG', color: 'white' }
                        }
                    }
                }
            });

            const vrotCtx = document.getElementById('vrotChart').getContext('2d');
            vrotChart = new Chart(vrotCtx, {
                type: 'line',
                data: {
                    labels: ['√âtat Actuel', 'R√©duction -30%', 'R√©duction -60%', 'Z√©ro-Friction'],
                    datasets: [{
                        label: 'Potentiel Rotoriel (Vrot)',
                        data: [1.0, 0.7, 0.4, 0.1],
                        borderColor: 'rgba(245, 158, 11, 0.8)',
                        backgroundColor: 'rgba(245, 158, 11, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.3,
                        pointBackgroundColor: 'white',
                        pointRadius: 6
                    }]
                },
                options: {
                    ...commonOptions,
                    scales: {
                        ...commonOptions.scales,
                        y: {
                            ...commonOptions.scales.y,
                            title: { display: true, text: 'Niveau de Friction', color: 'white' }
                        }
                    }
                }
            });
        }

        function updateCharts(SRG_initial, SRG_final, Vrot_reduction) {
            const reduction_ratio = Vrot_reduction / 100;
            
            srgChart.data.datasets[0].data = [
                SRG_initial,
                SRG_initial * 0.8,
                SRG_initial * 0.5,
                SRG_final
            ];
            
            const currentVrot = 1.0;
            const reducedVrot = currentVrot * (1 - reduction_ratio);
            
            vrotChart.data.datasets[0].data = [
                currentVrot,
                currentVrot * 0.7,
                currentVrot * 0.4,
                Math.max(reducedVrot, 0.05)
            ];
            
            srgChart.update();
            vrotChart.update();
        }

        window.onload = function() {
            initClavier();
        };
    </script>
</body>
</html>