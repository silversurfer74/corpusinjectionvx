<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TRI Pattern Hunter ‚Äî M√©ta-Th√©or√®mes I √† XI</title>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        // Configuration MathJax pour les formules en LaTeX
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                tags: 'ams'
            },
            chtml: {
                displayAlign: 'center',
                scale: 1.1
            }
        };
    </script>
    <style>
        /* CSS unifi√© bas√© sur style.css et les snippets */
        :root {
            --bg-primary: #0a0e27;
            --bg-secondary: #151b3d;
            --bg-card: #1a2347;
            --accent-primary: #00d9ff;
            --accent-secondary: #0fbf9a;
            --accent-warning: #ff6b6b;
            --text-primary: #e8f4f8;
            --text-secondary: #a8c5d1;
            --glass-bg: rgba(26, 35, 71, 0.6);
            --glass-border: rgba(0, 217, 255, 0.2);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            padding: 40px 0 20px;
            border-bottom: 1px solid var(--glass-border);
            margin-bottom: 30px;
        }
        
        header h1 {
            color: var(--accent-primary);
            font-size: 2.8rem;
            margin-bottom: 5px;
        }
        
        header .subtitle {
            color: var(--text-secondary);
            font-size: 1.2rem;
        }
        
        header .author {
            color: var(--accent-secondary);
            font-size: 0.9rem;
            margin-top: 5px;
        }
        
        section {
            margin-bottom: 40px;
            background: var(--glass-bg);
            border-radius: 15px;
            padding: 30px;
            border: 1px solid var(--glass-border);
            backdrop-filter: blur(5px);
        }

        h2 {
            font-size: 2rem;
            color: var(--accent-secondary);
            border-left: 4px solid var(--accent-primary);
            padding-left: 15px;
            margin-bottom: 25px;
        }
        
        .input-group {
            display: flex;
            gap: 15px;
        }
        
        #equationInput {
            flex-grow: 1;
            padding: 12px 15px;
            border-radius: 8px;
            border: 2px solid var(--glass-border);
            background: var(--bg-card);
            color: var(--text-primary);
            font-size: 1.1rem;
            font-family: 'Courier New', monospace;
        }
        
        #solveButton {
            background: var(--accent-primary);
            color: var(--bg-primary);
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.3s, transform 0.1s;
        }
        
        #solveButton:hover {
            background: #47f0ff;
        }
        
        #solveButton:active {
            transform: scale(0.98);
        }
        
        .results-section h3 {
            color: var(--accent-primary);
            margin-top: 15px;
            margin-bottom: 10px;
            font-size: 1.5rem;
        }
        
        .solution-formula {
            background: var(--bg-secondary);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            margin-top: 10px;
            margin-bottom: 20px;
            font-size: 1.2rem;
            border: 1px solid var(--accent-secondary);
        }

        /* NOUVEAUX STYLES CLAVIER */
        .keyboard {
            display: grid;
            grid-template-columns: repeat(6, 1fr); /* 6 colonnes pour un bon √©quilibre */
            gap: 10px;
            margin-top: 20px;
            padding: 15px;
            background: var(--bg-card);
            border-radius: 10px;
            border: 1px solid var(--glass-border);
        }

        .key-button {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: none;
            padding: 12px 5px;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.2s, transform 0.1s;
            user-select: none;
        }

        .key-button:hover {
            background: #25315e;
        }

        .key-operator {
            background: #3949ab; /* Bleu fonc√© pour les op√©rateurs */
        }

        .key-function {
            background: var(--accent-secondary); /* Vert-cyan pour les fonctions complexes (MT-specific) */
            color: var(--bg-primary);
            font-size: 0.75rem;
            font-weight: 700;
        }

        .key-operator:hover {
            background: #4e60df;
        }

        .key-function:hover {
            background: #23ccb1;
        }
        /* FIN NOUVEAUX STYLES CLAVIER */
        
        .meta-theorems-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }
        
        .meta-card {
            background: var(--bg-card);
            border: 2px solid var(--glass-border);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .meta-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent-primary);
            box-shadow: 0 10px 30px rgba(0, 217, 255, 0.3);
        }
        
        .meta-card h3 {
            color: var(--accent-primary);
            font-size: 1.5rem;
            margin-bottom: 10px;
        }
        
        .meta-card p {
            color: var(--text-secondary);
            margin-bottom: 10px;
        }
        
        .meta-card code {
            background: rgba(0, 0, 0, 0.3);
            padding: 5px 10px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            color: var(--accent-secondary);
            display: block;
        }

        .table-container {
            overflow-x: auto;
            margin-top: 25px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: var(--bg-card);
            border-radius: 10px;
            overflow: hidden;
            min-width: 800px;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--glass-border);
        }

        th {
            background: var(--bg-secondary);
            color: var(--accent-primary);
            font-size: 1rem;
            text-transform: uppercase;
        }

        td code {
            font-family: 'Courier New', monospace;
            background: rgba(0, 0, 0, 0.2);
            padding: 2px 5px;
            border-radius: 3px;
            color: var(--accent-secondary);
        }

        .success { color: var(--accent-secondary); }
        .failure { color: var(--accent-warning); }

        footer {
            text-align: center;
            padding: 20px 0;
            margin-top: 40px;
            border-top: 1px solid var(--glass-border);
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üåê TRI Pattern Hunter (M√©ta I √† XI)</h1>
            <p class="subtitle">R√©solution √©l√©gante par reconnaissance de patterns r√©sonants</p>
            <p class="author">Bas√© sur la Th√©orie de la R√©sonance Informationnelle (TRI) - Rachid Azzouz</p>
        </header>

        <main>
            <section class="input-section">
                <h2>üîç Equation Solver (P8 ‚Üí P6 ‚Üí P5)</h2>
                <div class="input-group">
                    <input type="text" id="equationInput" placeholder="Ex: 3^x - (sqrt(3))^(x+4) + 20 = 0">
                    <button id="solveButton" onclick="solveEquation()">Analyser le Pattern</button>
                </div>

                <div id="keyboard" class="keyboard">
                    <button class="key-button" onclick="insertChar('7')">7</button>
                    <button class="key-button" onclick="insertChar('8')">8</button>
                    <button class="key-button" onclick="insertChar('9')">9</button>
                    <button class="key-button" onclick="insertChar('(')">(</button>
                    <button class="key-button" onclick="insertChar(')')">)</button>
                    <button class="key-button key-operator" onclick="insertChar('Del')">DEL</button>
                    
                    <button class="key-button" onclick="insertChar('4')">4</button>
                    <button class="key-button" onclick="insertChar('5')">5</button>
                    <button class="key-button" onclick="insertChar('6')">6</button>
                    <button class="key-operator" onclick="insertChar('*')">*</button>
                    <button class="key-operator" onclick="insertChar('/')">/</button>
                    <button class="key-operator" onclick="insertChar('=')">=</button>

                    <button class="key-button" onclick="insertChar('1')">1</button>
                    <button class="key-button" onclick="insertChar('2')">2</button>
                    <button class="key-button" onclick="insertChar('3')">3</button>
                    <button class="key-operator" onclick="insertChar('+')">+</button>
                    <button class="key-operator" onclick="insertChar('-')">-</button>
                    <button class="key-button" onclick="insertChar('x')">x</button>
                    
                    <button class="key-button" onclick="insertChar('0')">0</button>
                    <button class="key-button" onclick="insertChar('.')">.</button>
                    <button class="key-button" onclick="insertChar('^')">^</button>
                    <button class="key-function" onclick="insertChar('func:sqrt')">sqrt(.)</button>
                    <button class="key-function" onclick="insertChar('func:ex')">e^x</button>
                    <button class="key-function" onclick="insertChar('func:loga')">log_a(.)</button>

                    <button class="key-function" onclick="insertChar('func:sin2')">sin¬≤ x</button>
                    <button class="key-function" onclick="insertChar('func:cos2')">cos¬≤ x</button>
                    <button class="key-function" onclick="insertChar('func:tan2')">tan¬≤ x</button>
                    <button class="key-function" onclick="insertChar('func:sec2')">sec¬≤ x</button>
                    <button class="key-function" onclick="insertChar('func:cosh2')">cosh¬≤ x</button>
                    <button class="key-function" onclick="insertChar('func:sinh2')">sinh¬≤ x</button>
                </div>
                <div id="results" class="results-section" style="display: none;">
                    <div id="metaDetection"></div>
                    <div id="p8Verification"></div>
                    <div id="p5Solution"></div>
                </div>
            </section>
            
            <section class="summary-section">
                <h2>üìö Tableau R√©capitulatif des 11 M√©ta-Th√©or√®mes</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Famille</th>
                                <th>Pattern Canonique (P8)</th>
                                <th>Rotor (P6)</th>
                                <th>Fr√©quence ($\omega_c$)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>MT I</td><td>Alg√©brique</td><td><code>x^m - x^n = K</code> ($\frac{n}{m}=\frac{3}{2}$)</td><td>$u = x^{m/2}$</td><td>$\pi^2/6$ (Harmonique)</td></tr>
                            <tr><td>MT II</td><td>Alg√©brique</td><td>$x^4 + x^3 + x^2 + x + 1 = 0$ (R√©ciproque)</td><td>$u = x + \frac{1}{x}$</td><td>$\phi \approx 1.618$ (Fibonacci)</td></tr>
                            <tr><td>MT III</td><td>Alg√©brique</td><td>$x^3 + ax^2 + bx - (a+b+1) = 0$</td><td>$P(1) = 0$ (Factorisation)</td><td>$e \approx 2.718$ (Croissance)</td></tr>
                            <tr><td>MT IV</td><td>Transc. (Trigo I)</td><td>$a^{\sin^2 x} + a^{\cos^2 x} = a+1$</td><td>$\sin^2 x + \cos^2 x = 1$</td><td>$\pi$ (P√©riodicit√©)</td></tr>
                            <tr><td>MT V</td><td>Transc. (Trigo II)</td><td>$b^{\tan^2 x} + b^{\sec^2 x} = 1+b^2$</td><td>$\sec^2 x = 1 + \tan^2 x$</td><td>$\pi$ (P√©riodicit√©)</td></tr>
                            <tr><td>MT VI</td><td>Diophantienne</td><td>$\frac{1}{a} + \frac{1}{b} = \frac{1}{N}$ (en $\mathbb{Z}$)</td><td>$a = N+p, b = N+q$</td><td>$N$ (R√©cursif)</td></tr>
                            <tr><td>MT VII</td><td>Irrationnelle</td><td>$\sqrt{x+A} - \sqrt{x+B} = \sqrt{C}$</td><td>Double √©l√©vation au carr√©</td><td>$|\Delta|$ (Stabilit√©)</td></tr>
                            <tr><td>MT VIII</td><td>Transc. (Hyper.)</td><td>$b^{\cosh^2 x} - b^{\sinh^2 x} = b-1$</td><td>$\cosh^2 x - \sinh^2 x = 1$</td><td>$e$ (Croissance)</td></tr>
                            <tr><td>MT IX</td><td>Transc. (Lambert)</td><td>$x e^x = K$</td><td>Fonction $W$ de Lambert</td><td>$W(K)$ (Fonctionnelle)</td></tr>
                            <tr><td>MT X</td><td>Transc. (Fract.)</td><td>$a^x + b^x = c^x$ (ex: $3^x+6^x=12^x$)</td><td>$t = (\frac{b}{c})^x$</td><td>$\log_2(\phi)$ (Auto-similaire)</td></tr>
                            <tr><td>MT XI ‚úÖ</td><td>Transc. (Expo. $n$)</td><td>$\mathbf{a^x - (\sqrt{a})^{x+k} + c = 0}$</td><td>$\mathbf{u = a^{x/2}}$ (Cascade)</td><td>$\mathbf{\pi^2/6}$ (Harmonique)</td></tr>
                        </tbody>
                    </table>
                </div>
            </section>
        </main>

        <footer>
            <p>M√©ta-Th√©or√®me Azzouz ‚Äî Th√©orie de la R√©sonance Informationnelle (TRI). Tous droits r√©serv√©s ¬© 2025.</p>
        </footer>
    </div>

    <script>
        // Fonction pour ins√©rer du texte √† la position du curseur
        function insertAtCursor(input, textToInsert, cursorPosOffset = 0) {
            const start = input.selectionStart;
            const end = input.selectionEnd;
            const value = input.value;
            
            input.value = value.substring(0, start) + textToInsert + value.substring(end);
            
            // Placer le curseur apr√®s l'insertion, ou √† l'int√©rieur de la parenth√®se si sp√©cifi√©
            input.selectionStart = input.selectionEnd = start + textToInsert.length - cursorPosOffset;
            input.focus();
        }

        // Gestionnaire d'√©v√©nements pour le clavier virtuel
        function insertChar(char) {
            const input = document.getElementById('equationInput');
            
            if (char === 'Del') {
                const start = input.selectionStart;
                const end = input.selectionEnd;
                const value = input.value;

                if (start > 0 && start === end) {
                    // Supprimer le caract√®re pr√©c√©dent
                    input.value = value.substring(0, start - 1) + value.substring(end);
                    input.selectionStart = input.selectionEnd = start - 1;
                } else if (start !== end) {
                    // Supprimer la s√©lection
                    input.value = value.substring(0, start) + value.substring(end);
                    input.selectionStart = input.selectionEnd = start;
                }
            } else if (char.startsWith('func:')) {
                let text = '';
                let offset = 0; // D√©calage pour placer le curseur (ex: dans sqrt(HERE))
                switch (char) {
                    case 'func:sqrt':
                        text = 'sqrt(...)';
                        offset = 1; // Placer le curseur avant la parenth√®se fermante
                        break;
                    case 'func:sin2':
                        text = 'sin^2 x';
                        break;
                    case 'func:cos2':
                        text = 'cos^2 x';
                        break;
                    case 'func:tan2':
                        text = 'tan^2 x';
                        break;
                    case 'func:sec2':
                        text = 'sec^2 x';
                        break;
                    case 'func:cosh2':
                        text = 'cosh^2 x';
                        break;
                    case 'func:sinh2':
                        text = 'sinh^2 x';
                        break;
                    case 'func:ex':
                        text = 'e^x';
                        break;
                    case 'func:loga':
                        text = 'log_a(...)';
                        offset = 1; 
                        break;
                    default:
                        text = char;
                }
                insertAtCursor(input, text, offset);
            } else {
                insertAtCursor(input, char);
            }
        }


        // Op√©rateur pour trouver le facteur p tel que K = p¬≤(p+1)
        function findP(K) {
            K = Math.abs(K);
            for (let p = 1; p <= 100; p++) {
                if (p * p * (p + 1) === K) {
                    return p;
                }
            }
            return null;
        }

        // --- Biblioth√®que compl√®te des M√©ta-Th√©or√®mes (P8 ‚Üí P6 ‚Üí P5) ---
        const metaTheorems = {
            'MT1': {
                name: "M√©ta-Th√©or√®me I - R√©sonance Polynomiale",
                canonical: "x^m - x^n = K (o√π n/m = 3/2)",
                description: "R√©duction par $u = x^{m/2}$ en forme quadratique si $K = p^2(p+1)$.",
                detect: function(equation) {
                    const match = equation.match(/x\^(\d+)\s*-\s*x\^(\d+)\s*=\s*([+-]?\d+)/);
                    if (!match) return false;
                    const m = parseInt(match[1]), n = parseInt(match[2]), K = parseInt(match[3]);
                    const p = findP(K);
                    return (n * 2 === m * 3 && p) ? { m, n, K, p } : false;
                },
                solve: function(params) {
                    const { m, n, K, p } = params;
                    const solution = `x = (${K > 0 ? -p : p})^{2/${m}}`;
                    return {
                        success: true,
                        steps: [`Condition P8 : n/m = ${n}/${m} = 3/2 ‚úì`, `Rotor P6 : $u^2 - u = ${K}$ (avec $u = x^{m/2}$).`, `Solution P5 trouv√©e avec p=${p}.`],
                        solution: `x = \\left( ${K > 0 ? -p : p} \\right)^{2/${m}}`,
                        verification: `V√©rifi√© pour $K=${K}$.`
                    };
                }
            },
            'MT4': {
                name: "M√©ta-Th√©or√®me IV - R√©sonance Trigonom√©trique I ($\sin^2 x / \cos^2 x$)",
                canonical: "a^(sin¬≤x) + a^(cos¬≤x) = 1+a",
                description: "R√©solution triviale utilisant l'identit√© $\\sin^2 x + \\cos^2 x = 1$.",
                detect: function(equation) {
                    const match = equation.match(/(\d+)\^\(sin\^2\s*x\)\s*\+\s*(\d+)\^\(cos\^2\s*x\)\s*=\s*(\d+)/);
                    if (!match) return false;
                    const a1 = parseInt(match[1]), a2 = parseInt(match[2]), K = parseInt(match[3]);
                    return (a1 === a2 && K === a1 + 1) ? { a: a1 } : false;
                },
                solve: function() {
                    return {
                        success: true,
                        steps: [`Condition P8 : $\\sin^2 x + \\cos^2 x = 1$ ‚úì`, `Rotor P6 : $a^{\\sin^2 x} + a^{1-\\sin^2 x} = a+1$. Solution $\\sin^2 x = 1$ ou $\\sin^2 x = 0$.`, `Solution P6 : $\\sin x = 0$ ou $\\cos x = 0$.`],
                        solution: "x = k\\pi \\quad \\text{ou} \\quad x = \\frac{\\pi}{2} + k\\pi, \\quad k \\in \\mathbb{Z}",
                        verification: "V√©rifi√© par la relation $a^1 + a^0 = a+1$ ou $a^0 + a^1 = a+1$."
                    };
                }
            },
            'MT5': {
                name: "M√©ta-Th√©or√®me V - R√©sonance Trigonom√©trique II ($\tan^2 x / \sec^2 x$)",
                canonical: "b^(tan¬≤x) + b^(sec¬≤x) = 1+b^2",
                description: "R√©solution utilisant l'identit√© $\\sec^2 x = 1 + \\tan^2 x$.",
                detect: function(equation) {
                    const match = equation.match(/(\d+)\^\(tan\^2\s*x\)\s*\+\s*(\d+)\^\(sec\^2\s*x\)\s*=\s*([+-]?\d+)/);
                    if (!match) return false;
                    const b1 = parseInt(match[1]), b2 = parseInt(match[2]), K = parseInt(match[3]);
                    // Simplification: b^t + b^(t+1) = b^t(1+b) = K.
                    return (b1 === b2 && K === b1 * (1 + b1)) ? { b: b1 } : false;
                },
                solve: function() {
                    return {
                        success: true,
                        steps: [`Condition P8 : $\\sec^2 x = 1 + \\tan^2 x$ ‚úì`, `Rotor P6 : $b^{\\tan^2 x} + b^{1+\\tan^2 x} = b^{\\tan^2 x} (1+b)$.`, `L'√©quation se r√©duit √† $b^{\\tan^2 x} (1+b) = b(1+b)$, donc $\\tan^2 x = 1$.`, `Solution P5 : $\\tan x = \\pm 1$.`],
                        solution: "x = \\frac{\\pi}{4} + k\\frac{\\pi}{2}, \\quad k \\in \\mathbb{Z}",
                        verification: "V√©rifi√© par $\\tan^2 x = 1$ et $\\sec^2 x = 2$."
                    };
                }
            },
            'MT8': {
                name: "M√©ta-Th√©or√®me VIII - R√©sonance Hyperbolique",
                canonical: "b^(cosh¬≤x) - b^(sinh¬≤x) = b-1",
                description: "R√©solution utilisant l'identit√© hyperbolique $\\cosh^2 x - \\sinh^2 x = 1$.",
                detect: function(equation) {
                    const match = equation.match(/(\d+)\^\(cosh\^2\s*x\)\s*-\s*(\d+)\^\(sinh\^2\s*x\)\s*=\s*([+-]?\d+)/);
                    if (!match) return false;
                    const b1 = parseInt(match[1]), b2 = parseInt(match[2]), K = parseInt(match[3]);
                    return (b1 === b2 && K === b1 - 1) ? { b: b1 } : false;
                },
                solve: function(params) {
                    const { b } = params;
                    return {
                        success: true,
                        steps: [`Condition P8 : $\\cosh^2 x - \\sinh^2 x = 1$ ‚úì`, `Rotor P6 : $b^{\\sinh^2 x+1} - b^{\\sinh^2 x} = b-1$.`, `Factorisation : $b^{\\sinh^2 x}(b-1) = b-1$. Donc $b^{\\sinh^2 x} = 1$.`, `Solution P5 : $\\sinh^2 x = 0$, donc $\\sinh x = 0$.`],
                        solution: "x = 0",
                        verification: `V√©rifi√©: $b^{\\cosh^2 0} - b^{\\sinh^2 0} = b^1 - b^0 = b-1$.`
                    };
                }
            },
            'MT10': {
                name: "M√©ta-Th√©or√®me X - R√©sonance Fractale (Exemple $\log_2(\phi)$)",
                canonical: "a^x + b^x = c^x (type 3^x + 6^x = 12^x)",
                description: "R√©duction par $t = (a/c)^x$ √† une forme quadratique (ex: $\\phi$ li√©e).",
                detect: function(equation) {
                    const match = equation.match(/(\d+)\^x\s*\+\s*(\d+)\^x\s*=\s*(\d+)\^x/);
                    if (!match) return false;
                    const a = parseInt(match[1]), b = parseInt(match[2]), c = parseInt(match[3]);
                    // Exemple bas√© sur l'analogie 3^x + 6^x = 12^x
                    return (a / c + b / c === 1) ? { a, b, c } : false;
                },
                solve: function(params) {
                    const { a, b, c } = params;
                    // Simplification: (a/c)^x + (b/c)^x = 1. Si a/c = k^2 et b/c = k. t^2 + t - 1 = 0
                    // On suppose le cas canonique pour MT-X (log_2(phi))
                    const t = (Math.sqrt(5) - 1) / 2;
                    const ratio = b/c;
                    const solution_num = Math.log(t) / Math.log(ratio); // log_b/c(t)
                    
                    return {
                        success: true,
                        steps: [`Condition P8 : Diviser par $c^x$ donne $(a/c)^x + (b/c)^x = 1$.`, `Rotor P6 : R√©duction √† une forme quadratique (ex: $t^2 + t - 1 = 0$ pour un cas sp√©cifique).`, `Solution P5 : $t = \\phi^{-1}$.`],
                        solution: `x = \\log_{${ratio.toFixed(2)}}(\\phi^{-1})`,
                        verification: `Pour $a=${a}, b=${b}, c=${c}$: $x \\approx ${solution_num.toFixed(4)}$`
                    };
                }
            },
            'MT11': {
                name: "M√©ta-Th√©or√®me XI - R√©sonance Exponentielle $n$-Niveaux (n=2)",
                canonical: "a^x - (a^(1/2))^(x+k) + c = 0",
                description: "R√©duction par Substitution en Cascade ($u = a^{x/2}$) en forme polynomiale.",
                detect: function(equation) {
                    const match = equation.match(/(\d+)\^x\s*-\s*\((?:sqrt)?\s*(\d+)\s*\)\^\(x\s*\+\s*([+-]?\d+)\)\s*\+\s*([+-]?\d+)\s*=\s*0/);
                    if (!match) return false;

                    const a = parseInt(match[1]);
                    const b = parseInt(match[2]);
                    const k = parseInt(match[3]);
                    const c = parseInt(match[4]);
                    const n = 2; 
                    
                    if (b * b !== a) return false; 
                    
                    const coef_u = Math.pow(a, k / n); 
                    const discriminant = coef_u * coef_u - 4 * c;

                    return { a, k, c, coef_u, discriminant, n };
                },
                solve: function(params) {
                    const { a, k, c, coef_u, discriminant, n } = params;

                    if (discriminant < 0) {
                        return { success: false, reason: `Conditions P8 non satisfaites : Discriminant (Œî = ${discriminant.toFixed(2)}) est n√©gatif. Aucune solution r√©elle (Th√©or√®me 11.1).` };
                    }
                    
                    const u1 = (coef_u + Math.sqrt(discriminant)) / 2;
                    const u2 = (coef_u - Math.sqrt(discriminant)) / 2;

                    const solutions_u = [u1, u2].filter(u => u > 0);
                    
                    if (solutions_u.length === 0) {
                         return { success: false, reason: "Les solutions interm√©diaires (u) sont toutes n√©gatives ou nulles. Aucune solution r√©elle pour x." };
                    }
                    
                    const x_solutions = solutions_u.map(u => n * Math.log(u) / Math.log(a));
                    const solution_str = x_solutions.length === 1 ? `x = ${n} \\log_{${a}}(${solutions_u[0].toFixed(3)})` : 
                                                                    `x_1 = ${n} \\log_{${a}}(${solutions_u[0].toFixed(3)}), x_2 = ${n} \\log_{${a}}(${solutions_u[1].toFixed(3)})`;

                    return {
                        success: true,
                        steps: [`Condition P8 : R√©sonance de Base $a = b^n$ ‚úì`, `Rotor P6 : $u^n - ${coef_u.toFixed(3)}u + ${c} = 0$ (avec $u = a^{x/n}$).`, `P5 : Solution trouv√©e par $\\log_a$.`],
                        solution: solution_str,
                        verification: `Ex: x ‚âà ${x_solutions[0].toFixed(4)}`
                    };
                }
            }
            // Les autres MT (II, III, VI, VII, IX) sont mentionn√©s dans le tableau pour l'exhaustivit√© acad√©mique mais non cod√©s dans ce solveur simple.
        };

        // Fonction principale de l'Equation Solver
        function solveEquation() {
            const equation = document.getElementById('equationInput').value.trim();
            const resultsDiv = document.getElementById('results');
            const metaDetection = document.getElementById('metaDetection');
            const p8Verification = document.getElementById('p8Verification');
            const p5Solution = document.getElementById('p5Solution');

            resultsDiv.style.display = 'block';
            metaDetection.innerHTML = '';
            p8Verification.innerHTML = '';
            p5Solution.innerHTML = '';
            
            let detected = false;

            for (const key in metaTheorems) {
                const meta = metaTheorems[key];
                const detectionParams = meta.detect(equation);

                if (detectionParams) {
                    detected = true;
                    
                    metaDetection.innerHTML = `
                        <h3>‚úÖ ${meta.name} (${key})</h3>
                        <p><strong>Forme canonique :</strong> <code>${meta.canonical}</code></p>
                        <p>${meta.description}</p>
                    `;

                    const result = meta.solve(detectionParams);
                    
                    if (result.success) {
                        p8Verification.innerHTML = `
                            <h3>üîé V√©rification P8 et Rotor P6</h3>
                            ${result.steps.map(step => `<p class="success">‚úì ${step}</p>`).join('')}
                        `;
                        p5Solution.innerHTML = `
                            <h3>‚ú® Solution √©l√©gante (P5)</h3>
                            <div class="solution-formula">$$\\text{Solution : } ${result.solution}$$</div>
                            <p><strong>V√©rification :</strong> ${result.verification}</p>
                        `;
                    } else {
                        p8Verification.innerHTML = `
                            <h3>‚ùå Conditions de R√©sonance non satisfaites</h3>
                            <p class="failure">${result.reason}</p>
                        `;
                        p5Solution.innerHTML = '';
                    }

                    MathJax.typeset();
                    return; 
                }
            }

            if (!detected) {
                metaDetection.innerHTML = `
                    <h3>‚ùå Aucun Pattern R√©sonant D√©tect√©</h3>
                    <p class="failure">L'√©quation n'a pas r√©sonn√© avec les M√©ta-Th√©or√®mes principaux cod√©s (MT I, IV, V, VIII, X, XI).</p>
                    <p>Veuillez utiliser les boutons du clavier ou v√©rifier le format (ex: <code>a^x - (sqrt(b))^(x+k) + c = 0</code>).</p>
                `;
                p8Verification.innerHTML = '';
                p5Solution.innerHTML = '';
            }
        }
    </script>
</body>
</html>